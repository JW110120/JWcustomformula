自定义混合模式（Photoshop UXP 插件）
## 能做什么
- 先选择“基底图层”和“混合图层”，插件自动读取两者像素。
- 两种模式：
  - 新公式：可以输入表达式，例如：`B * S`
  - 公式预设：保存的自定义公式。
- 点击“应用”，自动生成新图层“自定义混合结果”
- 预设管理：保存、删除、导入/导出预设（JSON），方便迁移与分享

## 公式怎么写
- 变量：
  - B是个向量，表示“基底图层”的四个通道，rb/gb/bb/ab对应基底图层的红通道/绿通道/蓝通道/alpha通道，单独一个B = [rb, gb, bb, ab]。
  - S是个向量，表示“混合图层”的四个通道，rs/gs/bs/as对应混合图层的红通道/绿通道/蓝通道/alpha通道，单独一个S = [rs, gs, bs, as]。
  - 数值范围：0-1（插件会把图层像素 0-255 先归一化到 0-1 进行计算，写回时乘以 255 并四舍五入）
  - 写公式时不用自己 /255 或 *255；直接用 B 和 T 即可，必要时用 clamp(x, 0, 1)
- 一些例子：
  - 正常：`S`
  - 正片叠底：`B * S`
  - 滤色：`B + S - B * S`
  - 叠加：`B < 0.5 ? 2 * B * S : 1 - 2 * (1 - B) * (1 - S)`
  - 防溢出：`clamp (B + S, 0, 1)`

提示：返回“向量”或“标量”都可以：
- 向量：如 [r, g, b] 或 [r, g, b, a]
- 标量：如果你在新公式输入框里只输一个数（比如 0.7），插件会把它同时赋给 R/G/B 三个通道。
- 假如你在输入框中输入的向量中没有指定 alpha 通道的话，最终结果的 alpha 通道默认用基底图层的 alpha 通道。

## 安装方法
由于核心算法使用Imaging API，所以对PS版本有要求。
要求：Photoshop 24.4 及以上

- 直接拷贝dist文件
- 通过云盘下载已经编译好的dist文件，拷贝到PS目录中的插件文件中：
- 插件下载地址：
- 链接: https://pan.baidu.com/s/1QlsBX2qnXDmClwGxvD_Vlg?pwd=rdrg 提取码: rdrg
- 假如PS装在C盘则需要把文件解压后放入：C:\Program Files\Adobe\Adobe Photoshop 2025\Plug-ins

## 怎么用
1. 在 PS 里打开一个 RGB 8 位文档（最稳妥的模式）
2. 在PS顶部导航栏找到增效工具> 自定义混合模式
3. 顶部选“基底图层”“混合图层”
4. 中间选“公式预设”或“新公式”（新公式里输入表达式）
5. 点击底部“应用”，会生成一个新图层“自定义混合结果”
6. 如果喜欢当前公式，可点“保存”；也支持“导入/导出预设”

## 注意事项
- 目前只支持 RGB 8 位；其他色彩/位深建议先转换（结果在 8-bit sRGB 下计算）
- 特殊图层（文字、形状、智能对象、调整层）会自动转为临时像素再计算，不影响原图层
- 大图会分块处理，耗时稍久，请耐心等候


有问题或建议欢迎提出。祝使用顺手！
